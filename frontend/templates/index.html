<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SourceSense - Elasticsearch Connector</title>
    <link
      rel="icon"
      type="image/png"
      sizes="96x96"
      href="https://atlan.com/favicon-96x96.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="https://atlan.com/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="https://atlan.com/favicon-16x16.png"
    />
    <link rel="stylesheet" href="{{ url_for('static', path='styles.css') }}" />
  </head>
  <body>
    <script>
      // Environment variables for the frontend
      window.env = {
        APP_HTTP_HOST: "{{ app_http_host }}",
        APP_HTTP_PORT: "{{ app_http_port }}",
        APP_DASHBOARD_HTTP_HOST: "{{ app_dashboard_http_host }}",
        APP_DASHBOARD_HTTP_PORT: "{{ app_dashboard_http_port }}",
        TENANT_ID: "{{ tenant_id }}",
        APP_NAME: "{{ app_name }}",
        TEMPORAL_UI_HOST: "{{ workflow_ui_host }}",
        TEMPORAL_UI_PORT: "{{ workflow_ui_port }}",
      };
    </script>
    <div class="container">
      <!-- Header -->
      <header class="header">
        <div class="logo-container">
          <img
            src="https://upload.wikimedia.org/wikipedia/commons/f/f4/Elasticsearch_logo.svg"
            alt="Elasticsearch Logo"
            class="logo"
            width="100"
            height="100"
          />
          <h1>SourceSense</h1>
          <span class="subtitle">Elasticsearch Metadata Connector</span>
        </div>
        <div class="doc-link">
          <a
            href="https://github.com/atlanhq/atlan-sample-apps"
            target="_blank"
            class="doc-link-button"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              width="24"
              height="24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25"
              />
            </svg>
            <span>Documentation</span>
          </a>
        </div>
      </header>

      <div class="main-content">
        <!-- Sidebar -->
        <div class="sidebar">
          <div class="step-list">
            <div class="step active" data-step="1" onclick="goToPage(1)">
              <div class="step-indicator">1</div>
              <span>Credential</span>
            </div>
            <div class="step" data-step="2" onclick="goToPage(2)">
              <div class="step-indicator">2</div>
              <span>Connection</span>
            </div>
            <div class="step" data-step="3" onclick="goToPage(3)">
              <div class="step-indicator">3</div>
              <span>Metadata</span>
            </div>
          </div>
        </div>

        <!-- Form Container -->
        <div class="form-container">
          <!-- Page 1: Credentials -->
          <div id="page1" class="page active">
            <div class="form-group horizontal">
              <div class="input-wrapper flex-grow">
                <label>Host *</label>
                <input
                  type="text"
                  id="host"
                  placeholder="elasticsearch.example.com"
                />
              </div>
              <div class="input-wrapper" style="width: 100px">
                <label>Port *</label>
                <input type="text" id="port" value="9200" />
              </div>
            </div>

            <div class="form-group horizontal">
              <div class="input-wrapper flex-half">
                <label>Protocol *</label>
                <select id="protocol">
                  <option value="https">HTTPS</option>
                  <option value="http">HTTP</option>
                </select>
              </div>
              <div class="input-wrapper flex-half">
                <label>SSL Verification</label>
                <select id="ssl_verify">
                  <option value="true">Enabled (Recommended)</option>
                  <option value="false">Disabled (Development Only)</option>
                </select>
              </div>
            </div>

            <div class="section">
              <h2>Authentication</h2>
              <div class="button-group" id="authTypeGroup">
                <button class="btn btn-primary" data-auth="basic">Basic</button>
                <button class="btn btn-secondary" data-auth="api_key">
                  API Key
                </button>
                <button class="btn btn-secondary" data-auth="bearer">
                  Bearer Token
                </button>
              </div>
            </div>

            <!-- Basic Authentication Section -->
            <div id="basic-auth" class="auth-section active">
              <div class="form-group horizontal">
                <div class="input-wrapper flex-half">
                  <label>Username *</label>
                  <input type="text" id="username" placeholder="elastic" />
                </div>
                <div class="input-wrapper flex-half">
                  <label>Password *</label>
                  <input type="password" id="password" placeholder="Password" />
                </div>
              </div>
            </div>

            <!-- API Key Authentication Section -->
            <div id="api_key-auth" class="auth-section">
              <div class="form-group horizontal">
                <div class="input-wrapper flex-half">
                  <label>API Key ID *</label>
                  <input type="text" id="api_key_id" placeholder="API Key ID" />
                </div>
                <div class="input-wrapper flex-half">
                  <label>API Key *</label>
                  <input type="password" id="api_key" placeholder="API Key" />
                </div>
              </div>
            </div>

            <!-- Bearer Token Authentication Section -->
            <div id="bearer-auth" class="auth-section">
              <div class="form-group">
                <label>Bearer Token *</label>
                <input type="password" id="token" placeholder="Bearer Token" />
              </div>
            </div>

            <div class="form-group horizontal">
              <div class="input-wrapper flex-half">
                <label>Request Timeout (seconds)</label>
                <input
                  type="number"
                  id="timeout"
                  value="30"
                  min="5"
                  max="300"
                />
              </div>
              <div class="input-wrapper flex-half">
                <!-- Empty for spacing -->
              </div>
            </div>

            <div class="button-container">
              <button id="testConnectionBtn" class="btn btn-outline">
                Test Connection
              </button>
              <div id="connectionResult" class="error-message"></div>
            </div>
          </div>

          <!-- Page 2: Connection -->
          <div id="page2" class="page">
            <div class="form-group">
              <label>Connection Name *</label>
              <input
                type="text"
                id="connectionName"
                placeholder="My Elasticsearch Cluster"
              />
            </div>

            <div class="form-group">
              <label>Description</label>
              <textarea
                id="connectionDescription"
                placeholder="Description of this Elasticsearch connection..."
                rows="3"
              ></textarea>
            </div>
          </div>

          <!-- Page 3: Metadata -->
          <div id="page3" class="page">
            <div class="section">
              <h2>Extraction Scope</h2>

              <div class="form-group">
                <label>Index Pattern</label>
                <input
                  type="text"
                  id="indexPattern"
                  value="*"
                  placeholder="* (all indices) or specific pattern like logs-*"
                />
                <small class="help-text"
                  >Use * for all indices, or specify patterns like logs-*,
                  app-data-*</small
                >
              </div>

              <div class="form-group">
                <label class="checkbox-label">
                  <input type="checkbox" id="includeSystemIndices" />
                  <span class="checkmark"></span>
                  Include System Indices
                </label>
                <small class="help-text"
                  >Include Elasticsearch system indices (starting with .)</small
                >
              </div>

              <div class="form-group">
                <label class="checkbox-label">
                  <input type="checkbox" id="extractMappings" checked />
                  <span class="checkmark"></span>
                  Extract Field Mappings
                </label>
                <small class="help-text"
                  >Extract detailed field schema and type information</small
                >
              </div>

              <div class="form-group">
                <label class="checkbox-label">
                  <input type="checkbox" id="extractSettings" />
                  <span class="checkmark"></span>
                  Extract Index Settings
                </label>
                <small class="help-text"
                  >Extract shard configuration, analyzers, and other
                  settings</small
                >
              </div>

              <div class="form-group">
                <label class="checkbox-label">
                  <input type="checkbox" id="calculateQualityMetrics" />
                  <span class="checkmark"></span>
                  Calculate Quality Metrics
                </label>
                <small class="help-text"
                  >Analyze document counts, field completeness, and data
                  quality</small
                >
              </div>
            </div>

            <div class="section">
              <h2>Advanced Options</h2>

              <div class="form-group">
                <label>Batch Size</label>
                <input
                  type="number"
                  id="batchSize"
                  value="100"
                  min="10"
                  max="1000"
                />
                <small class="help-text"
                  >Number of indices to process in parallel</small
                >
              </div>

              <div class="form-group">
                <label>Max Field Depth</label>
                <input
                  type="number"
                  id="maxFieldDepth"
                  value="10"
                  min="1"
                  max="50"
                />
                <small class="help-text"
                  >Maximum depth for nested field analysis</small
                >
              </div>
            </div>

            <div class="button-container">
              <button id="startExtractionBtn" class="btn btn-primary">
                Start Metadata Extraction
              </button>
              <div id="extractionResult" class="status-message"></div>
            </div>

            <!-- Temporal UI Link -->
            <div class="button-container" style="margin-top: 20px">
              <a
                id="temporalLink"
                href="#"
                target="_blank"
                class="btn btn-outline"
                style="display: none"
                >View in Temporal UI</a
              >
            </div>
          </div>

          <!-- Navigation Buttons -->
          <div id="page1-nav" class="nav-buttons">
            <button onclick="nextPage()" class="btn btn-primary">Next</button>
          </div>

          <div id="page2-nav" class="nav-buttons" style="display: none">
            <button onclick="prevPage()" class="btn btn-secondary">
              Previous
            </button>
            <button onclick="nextPage()" class="btn btn-primary">Next</button>
          </div>

          <div id="page3-nav" class="nav-buttons" style="display: none">
            <button onclick="prevPage()" class="btn btn-secondary">
              Previous
            </button>
          </div>
        </div>
      </div>
    </div>

    <script src="{{ url_for('static', path='script.js') }}?v=20250913190000"></script>
  </body>
</html>
